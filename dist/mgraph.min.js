var $GL=function(t){return t.SinGraph=function(t,i){this.placeholder=t,this.plot=null,this.N=getOpts(i,"npoints",20),this.scope=getOpts(i,"scope",!1),this.nperiods=getOpts(i,"nperiods",1),this.tmin=getOpts(i,"tmin",-5),this.tmax=getOpts(i,"tmax",20),this.max=getOpts(i,"max",20),this.options={grid:{borderWidth:1,minBorderMargin:20,labelMargin:10,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:8,bottom:20,left:20},markings:[{xaxis:{from:-5,to:20},yaxis:{from:0,to:0},color:"#000"},{xaxis:{from:0,to:0},yaxis:{from:-20,to:20},color:"#000"}]},xaxis:{ticks:[-5,0,5,10,15,20],axisLabel:"temps (ms)"},yaxis:{min:-this.max,max:+this.max},legend:{show:!0}},this.scope&&(this.tmin=-10,this.tmax=10,this.options.grid.backgroundColor.colors=["#fff","#fff"],this.options.grid.markings=[{xaxis:{from:-10,to:10},yaxis:{from:0,to:0},color:"#000"},{xaxis:{from:0,to:0},yaxis:{from:-5,to:5},color:"#000"}],this.options.xaxis={ticks:[-10,-8,-6,-4,-2,0,2,4,6,8,10],axisLabel:null,color:"#aaa"},this.options.yaxis={ticks:[-5,-4,-3,-2,-1,0,1,2,3,4,5],axisLabel:null,color:"#aaa"})},t.SinGraph.prototype={draw:function(t){if(this.initialized){i=this._create_series(t);this.plot.setData(i),this.plot.draw()}else{this.initialized=!0;var i=this._create_series(t);this.plot=$.plot(this.placeholder,i,this.options)}},_create_sin:function(t,i){for(var s=[],e=0;e<=this.N;++e){var o=this.tmin,r=o+1*(this.tmax-o)*e/this.N,n=2*r*Math.PI*50/1e3,h=t*Math.sin(n+Math.PI/180*i);s.push([r,h])}return s},_create_series:function(t){series=[];for(var i=0;i<t.length;i++){var s={color:getOpts(t[i],"color","black"),data:this._create_sin(t[i].amplitude/(1*getOpts(t[i],"scale",1)),t[i].phase),lines:{fill:!1}};series.push(s)}return series},show_series:function(t,i){var s=this.plot.getData();s[t].lines.show=i,this.plot.setData(s),this.plot.draw()}},t}(($GL=function(t){return t.Series=function(t){this.opt=t,this.series=null,this.def_opt("points",null),this.def_opt("N",100),this.def_opt("min",0),this.def_opt("max",100),this.def_opt("fct",(function(t,i){return t})),this.def_opt("p",null),this.x1=null,this.d1=null,this._prefill()},t.Series.prototype={def_opt:function(t,i){void 0===this.opt||void 0===this.opt[t]?this[t]=i:this[t]=this.opt[t]},_prefill:function(){var t;if(null==this.points)for(this.points=new Array(this.N),this.series=null,t=0;t<this.N;t++){var i=this.min+t/(this.N-1)*(this.max-this.min);this.points[t]=i}},_prefill_series:function(t){this.series=new Array(t);for(var i=0;i<t;i++){this.series[i]=[];for(var s=0;s<this.points.length;s++)this.series[i][s]=[0,0]}},_prefill_series_from_function:function(t,i){var s=t(this.points[0],i),e=Array.isArray(s)?s.length:1;this._prefill_series(e)},compute:function(t,i){null==t&&null==i?(t=this.fct,i=this.p):null!=i||t&&t.constructor&&t.call&&t.apply?null==i&&(i=this.p):(i=t,t=this.fct),null==this.series&&this._prefill_series_from_function(t,i);for(var s=0;s<this.points.length;s++){var e=this.points[s],o=this.fct(e,i);if(Array.isArray(o))for(var r=0;r<o.length;r++)this.series[r][s]=[e,o[r]];else this.series[0][s]=[e,o]}},from_vector:function(t,i){var s;null==this.series&&(s="number"==typeof t[0]?1:void 0===i?t[0].length:"number"==typeof i?1:i.length,this._prefill_series(s));for(var e=0;e<this.points.length;e++){var o=this.points[e],r=t[e];if("number"==typeof r)this.series[0][e]=[o,r];else if(void 0===i)for(var n=0;n<r.length;n++)this.series[n][e]=[o,r[n]];else if("number"==typeof i)this.series[0][e]=[o,r[i]];else for(n=0;n<i.length;n++)this.series[n][e]=[o,r[i[n]]]}},intersect:function(t,i){var s,e,o,r,n,h,a,l=new Array;s=this.points[0],o=this.series[t][0][1]-this.series[i][0][1];for(var p=1;p<this.points.length;p++)n=this.series[t][p][1]-this.series[i][p][1],r=this.points[p],(o>0&&n<0||o<0&&n>0)&&(a=(e=this.series[t][p-1][1])+((h=(o*r-n*s)/(o-n))-s)*(this.series[t][p][1]-e)/(r-s),l.push([h,a])),s=r,o=n;return l}},t}(($GL=function(t){return t.DynGraph=function(i,s,e){this.initialized=!1,this.placeholder=i,this.plot=null,this.duration=t.getOpts(s,"duration",1),this.yaxes=t.getOpts(s,"yaxes",[{}]),this.plots=e,this.series=[],this.time=0,this.plot_options={grid:{borderWidth:1,minBorderMargin:10,labelMargin:5,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:5,bottom:5,left:5}},xaxis:{axisLabel:"time (s)",color:"black"},yaxes:this.yaxes,legend:{show:!0,position:"nw"}},this._init()},t.DynGraph.prototype={_init:function(){this.nplots=this.plots.length,this.series=[];for(var i=0;i<this.nplots;i++){var s={lines:{fill:!1},data:[]};t.copyObjectFields(this.plots[i],s,["color","label","yaxis"]),this.series.push(s)}this.plot=$.plot(this.placeholder,this.series,this.plot_options)},_update_x:function(){var t=this.plot.getOptions();t.xaxes[0].min=this.time-this.duration,t.xaxes[0].max=this.time},add:function(t,i){this.time+=t;for(var s=0;s<this.nplots;s++)for(this.series[s].data.push([this.time,i[s]]);this.series[s].data[0][0]<this.time-this.duration;)this.series[s].data.shift();this.plot.setData(this.series),this._update_x(),this.plot.setupGrid(),this.plot.draw()}},t}(($GL=function(t){return t.CharacGraph=function(t,i,s){this.initialized=!1,this.placeholder=t,this.plot=null,this.xaxis=$GL.getOpts(i,"xaxis",{}),this.yaxis=$GL.getOpts(i,"yaxis",{}),this.legend=$GL.getOpts(i,"legend",{});var e=$GL.getOpts(i,"interactive",!1);this.plots=s,this.series=[],this.plot_options={grid:{borderWidth:1,minBorderMargin:10,labelMargin:5,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:5,bottom:5,left:5}},xaxis:this.xaxis,yaxis:this.yaxis,legend:this.legend,pan:{interactive:e}},this._init()},t.CharacGraph.prototype={_init:function(){this.nplots=this.plots.length,this.series=[];for(var t=0;t<this.nplots;t++){var i={lines:{fill:!1,show:!0},points:{show:!1},data:[]};$GL.copyObjectFields(this.plots[t],i,["color","label","lines","points","data"]),this.series.push(i)}this.plot=$.plot(this.placeholder,this.series,this.plot_options)},add_series:function(t,i){this.series[t].data=i},update:function(){this.plot.setData(this.series),this.plot.setupGrid(),this.plot.draw()}},t}(($GL=function(t){return t.getOpts=function(t,i,s){return void 0===t||void 0===t[i]?s:t[i]},t.copyObjectFields=function(t,i,s){if(null===s)return{};for(var e=0;e<s.length;e++)void 0!==t[s[e]]&&(i[s[e]]=t[s[e]])},t}($GL||{}))||{}))||{}))||{}))||{});