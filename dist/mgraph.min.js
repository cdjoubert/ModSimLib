$GL={},function(t){function i(t,i,s){return void 0===t||void 0===t[i]?s:t[i]}$GL={copyObjectFields:function(t,i,s){if(null===s)return{};for(var o=0;o<s.length;o++)void 0!==t[s[o]]&&(i[s[o]]=t[s[o]])},getOpts:i},$GL.SinGraph=function(t,s){this.placeholder=t,this.plot=null,this.N=i(s,"npoints",20),this.scope=i(s,"scope",!1),this.nperiods=i(s,"nperiods",1),this.tmin=i(s,"tmin",-5),this.tmax=i(s,"tmax",20),this.max=i(s,"max",20),this.options={grid:{borderWidth:1,minBorderMargin:20,labelMargin:10,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:8,bottom:20,left:20},markings:[{xaxis:{from:-5,to:20},yaxis:{from:0,to:0},color:"#000"},{xaxis:{from:0,to:0},yaxis:{from:-20,to:20},color:"#000"}]},xaxis:{ticks:[-5,0,5,10,15,20],axisLabel:"temps (ms)"},yaxis:{min:-this.max,max:+this.max},legend:{show:!0}},this.scope&&(this.tmin=-10,this.tmax=10,this.options.grid.backgroundColor.colors=["#fff","#fff"],this.options.grid.markings=[{xaxis:{from:-10,to:10},yaxis:{from:0,to:0},color:"#000"},{xaxis:{from:0,to:0},yaxis:{from:-5,to:5},color:"#000"}],this.options.xaxis={ticks:[-10,-8,-6,-4,-2,0,2,4,6,8,10],axisLabel:null,color:"#aaa"},this.options.yaxis={ticks:[-5,-4,-3,-2,-1,0,1,2,3,4,5],axisLabel:null,color:"#aaa"})},$GL.SinGraph.prototype={draw:function(t){if(this.initialized){i=this._create_series(t);this.plot.setData(i),this.plot.draw()}else{this.initialized=!0;var i=this._create_series(t);this.plot=$.plot(this.placeholder,i,this.options)}},_create_sin:function(t,i){for(var s=[],o=0;o<=this.N;++o){var e=this.tmin,a=e+1*(this.tmax-e)*o/this.N,r=2*a*Math.PI*50/1e3,h=t*Math.sin(r+Math.PI/180*i);s.push([a,h])}return s},_create_series:function(t){series=[];for(var s=0;s<t.length;s++){var o={color:i(t[s],"color","black"),data:this._create_sin(t[s].amplitude/(1*i(t[s],"scale",1)),t[s].phase),lines:{fill:!1}};series.push(o)}return series},show_series:function(t,i){var s=this.plot.getData();s[t].lines.show=i,this.plot.setData(s),this.plot.draw()}},$GL.DefGraph=function(t,i,s){this.initialized=!1,this.placeholder=t,this.plot=null,this.duration=$ML.getOpts(i,"duration",1),this.yaxes=$ML.getOpts(i,"yaxes",[{}]),this.plots=s,this.series=[],this.time=0,this.plot_options={grid:{borderWidth:1,minBorderMargin:10,labelMargin:5,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:5,bottom:5,left:5}},xaxis:{axisLabel:"temps (s)",color:"black"},yaxes:this.yaxes,legend:{show:!0,position:"nw"}},this._init()},$GL.DefGraph.prototype={_init:function(){this.nplots=this.plots.length,this.series=[];for(var t=0;t<this.nplots;t++){var i={lines:{fill:!1},data:[]};$GL.copyObjectFields(this.plots[t],i,["color","label","yaxis"]),this.series.push(i)}this.plot=$.plot(this.placeholder,this.series,this.plot_options)},_update_x:function(){var t=this.plot.getOptions();t.xaxes[0].min=this.time-this.duration,t.xaxes[0].max=this.time},add:function(t,i){this.time+=t;for(var s=0;s<this.nplots;s++)for(this.series[s].data.push([this.time,i[s]]);this.series[s].data[0][0]<this.time-this.duration;)this.series[s].data.shift();this.plot.setData(this.series),this._update_x(),this.plot.setupGrid(),this.plot.draw()}},$GL.CarGraph=function(t,i,s){this.initialized=!1,this.placeholder=t,this.plot=null,this.duration=$GL.getOpts(i,"duration",1),this.xaxis=$GL.getOpts(i,"xaxis",{}),this.yaxis=$GL.getOpts(i,"yaxis",{}),this.legend=$GL.getOpts(i,"legend",{}),this.xmin=$GL.getOpts(i,"xmin",null),this.xmax=$GL.getOpts(i,"xmax",null),this.xnum=$GL.getOpts(i,"xnum",null),this.plots=s,this.series=[],this.plot_options={grid:{borderWidth:1,minBorderMargin:10,labelMargin:5,backgroundColor:{colors:["#fff","#e4f4f4"]},margin:{top:5,bottom:5,left:5}},xaxis:this.xaxis,yaxis:this.yaxis,legend:this.legend},this._init()},$GL.CarGraph.prototype={_init:function(){this.nplots=this.plots.length,this.series=[];for(var t=0;t<this.nplots;t++){var i={lines:{fill:!1},points:{show:!1},data:[]};$GL.copyObjectFields(this.plots[t],i,["color","label","lines","points","data"]),this.series.push(i)}this.plot=$.plot(this.placeholder,this.series,this.plot_options)},add_series:function(t,i){this.series[t].data=i},update:function(){this.plot.setData(this.series),this.plot.setupGrid(),this.plot.draw()}}}();